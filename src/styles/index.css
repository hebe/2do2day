@tailwind base;
@tailwind components;
@tailwind utilities;

/*
  index.css — calm light/dark theme + subtle category tinting

  Goals (based on your feedback):
  - Light mode: reduce the "grayish" wash in tinted rows (keep it crisp/white)
  - Dark mode: make category differences more visible without becoming loud

  How it works:
  - We define a neutral row surface token: --row-surface
  - Each category defines an accent: --cat-*
  - Category row classes mix surface + accent with different strengths per theme
  - Dark mode also gets a tiny "ink" edge to help scanning in dense lists

  Notes:
  - color-mix(in oklab, …) is supported in modern Chromium/Safari/Firefox.
  - A simple fallback is included for older browsers (it will still look fine).
*/

@layer base {
  :root {
    /* Base surfaces */
    --app-bg: #fdfdfe; /* your light base */
    --row-surface: oklch(0.99 0.002 260); /* cleaner than #fdfdfe => less gray tint */
    --row-hover: oklch(0.975 0.004 260);

    /* Borders / dividers */
    --row-border: oklch(0.90 0.01 260);

    /* Category accents (keep moderate chroma) */
    --cat-work: oklch(0.74 0.12 230);    /* sky */
    --cat-personal: oklch(0.78 0.12 155);/* mint */
    --cat-health: oklch(0.82 0.14 95);   /* amber */
    --cat-hobby: oklch(0.72 0.12 300);   /* violet */

    /* Mix strengths — LIGHT */
    --cat-bg-mix: 8%;       /* background tint strength */
    --cat-border-mix: 26%;  /* border tint strength */
    --cat-edge-mix: 65%;    /* (mostly unused in light) */
  }

  /* Tailwind typically toggles dark mode via class on <html> */
  .dark {
    --app-bg: #212936; /* your dark base */
    /* Slightly lighter than #212936 so subtle mixes show up more */
    --row-surface: oklch(0.30 0.03 255);
    --row-hover: oklch(0.34 0.03 255);
    --row-border: oklch(0.42 0.03 255);

    /* Mix strengths — DARK */
    --cat-bg-mix: 18%;
    --cat-border-mix: 40%;
    --cat-edge-mix: 70%;
  }

  /* Optional: if you want the whole page background to match --app-bg */
  body {
    background: var(--app-bg);
  }
}

@layer components {
  /* ---------- Base row look (used by your list rows) ---------- */
  .task-row-base {
    background: var(--row-surface);
    border-color: var(--row-border);
  }

  /* Hover on non-category rows (your JSX uses hover:bg-calm-50 / dark:hover:bg-gray-700) */
  .task-row-base:hover {
    background: var(--row-hover);
  }

  /* ---------- Category rows (used when TaskRow chooses categoryClass) ----------
     TaskRow maps:
       work     -> cat-row-work
       personal -> cat-row-personal
       health   -> cat-row-health
       hobby    -> cat-row-hobby
     (see TaskRow.jsx)
  */

  /* Shared rule: set an --accent per row */
  .cat-row-work { --accent: var(--cat-work); }
  .cat-row-personal { --accent: var(--cat-personal); }
  .cat-row-health { --accent: var(--cat-health); }
  .cat-row-hobby { --accent: var(--cat-hobby); }

  /* Preferred implementation (modern browsers): perceptual mix */
  @supports (background: color-mix(in oklab, white, black)) {
    .cat-row-work,
    .cat-row-personal,
    .cat-row-health,
    .cat-row-hobby {
      /* Background tint */
      background: color-mix(
        in oklab,
        var(--row-surface) calc(100% - var(--cat-bg-mix)),
        var(--accent) var(--cat-bg-mix)
      );

      /* Subtle divider/border tint (works nicely with your row separators) */
      border-color: color-mix(
        in oklab,
        var(--row-surface) calc(100% - var(--cat-border-mix)),
        var(--accent) var(--cat-border-mix)
      );
    }

    /* Hover: a touch stronger tint so it feels interactive */
    .cat-row-work:hover,
    .cat-row-personal:hover,
    .cat-row-health:hover,
    .cat-row-hobby:hover {
      background: color-mix(
        in oklab,
        var(--row-hover) calc(100% - (var(--cat-bg-mix) + 4%)),
        var(--accent) calc(var(--cat-bg-mix) + 4%)
      );
    }

    /* Dark-mode scan aid: tiny ink edge (keeps background subtle) */
    .dark .cat-row-work,
    .dark .cat-row-personal,
    .dark .cat-row-health,
    .dark .cat-row-hobby {
      position: relative;
    }

    .dark .cat-row-work::before,
    .dark .cat-row-personal::before,
    .dark .cat-row-health::before,
    .dark .cat-row-hobby::before {
      content: "";
      position: absolute;
      inset-block: 10px;
      inset-inline-start: 0;
      width: 3px;
      border-radius: 9999px;
      background: color-mix(
        in oklab,
        var(--row-surface) calc(100% - var(--cat-edge-mix)),
        var(--accent) var(--cat-edge-mix)
      );
      opacity: 0.9;
      pointer-events: none;
    }
  }

  /* Fallback for older browsers: still pleasant, just less fancy */
  @supports not (background: color-mix(in oklab, white, black)) {
    .cat-row-work,
    .cat-row-personal,
    .cat-row-health,
    .cat-row-hobby {
      background: var(--row-surface);
      border-color: var(--row-border);
    }

    /* If you want a fallback hint, uncomment a left border:
    .dark .cat-row-work, .dark .cat-row-personal, .dark .cat-row-health, .dark .cat-row-hobby {
      border-left: 3px solid rgba(255,255,255,0.08);
    }
    */
  }
}

/* If you prefer to consume these via Tailwind utilities only,
   you can ignore .task-row-base and just use the cat-row-* classes. */
